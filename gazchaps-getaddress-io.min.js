!function(e){var t=[];function d(e,t){if(gazchaps_getaddress_io.hide_address_fields&&gazchaps_getaddress_io.fields_to_hide&&gazchaps_getaddress_io.field_prefixes){gazchaps_getaddress_io.fields_to_hide;for(var d in gazchaps_getaddress_io.field_prefixes){var i=gazchaps_getaddress_io.field_prefixes[d];if(!e||i===e){var o=!1,a=i+"_country",n=document.getElementById(a);n&&(n.value&&"GB"==n.value||n.options&&"GB"==n.options[n.selectedIndex].value)&&(o=!0);var r=!0;for(var _ in gazchaps_getaddress_io.fields_to_hide){var c=i+"_"+gazchaps_getaddress_io.fields_to_hide[_],l=document.getElementById(c);if(l&&""!=l.value){r=!1;break}}if(r&&o||"show"===t){for(var _ in gazchaps_getaddress_io.fields_to_hide){c=i+"_"+gazchaps_getaddress_io.fields_to_hide[_];var g=document.getElementById(c+"_field");g&&(g.style.display="hide"==t?"none":"")}"hide"===t&&s(i,"show")}else"hide"===t&&s(i,"hide")}}}}function s(e,t){var d=e+"_gazchaps_getaddress_io_enter_address_manually_button_field",s=document.getElementById(d);s&&(s.style.display="hide"==t?"none":"")}function i(e){d(e,"hide")}function o(e){d(e,"show"),s(e,"hide")}function a(e){var d="";if(e.id.indexOf("billing_")>-1?d="billing":e.id.indexOf("shipping_")>-1&&(d="shipping"),d){var s=document.getElementById(d+"_postcode").value.replace(/[^A-Za-z0-9]/g,"").toUpperCase();s.length>0&&function(e,d,s){if(void 0!==t[e+"_"+d])return n(t[e+"_"+d]),void r(t[e+"_"+d]);var i;if(i="action=gazchaps_woocommerce_getaddress_io",i+="&postcode="+e,i+="&address_type="+d,XMLHttpRequest){s&&(s.innerText=gazchaps_getaddress_io.searching_text,s.disabled=!0);var o=new XMLHttpRequest;o.open("POST",gazchaps_getaddress_io.ajax_url),o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.onload=function(){s&&(s.innerText=gazchaps_getaddress_io.button_text,s.disabled=!1);var i=JSON.parse(o.responseText);i.error_code?alert(i.error):(t[e+"_"+d]=i,n(i),r(i))},o.onerror=function(){s&&(s.innerText=gazchaps_getaddress_io.button_text,s.disabled=!1)},o.send(i)}}(s,d,e)}}function n(e){var t=document.getElementById(e.address_type+"_postcode");t&&e.postcode&&(t.value=e.postcode)}function r(t){var d=t.address_type+"_gazchaps-woocommerce-getaddress-io-address-selector",s=document.getElementById(d);(s&&s.parentNode.removeChild(s),t.address_count>0)&&(document.getElementById(t.address_type+"_gazchaps_getaddress_io_postcode_lookup_button_field").insertAdjacentHTML("afterend",t.fragment.trim()),e&&e.fn.select2&&e("#"+d).find("select").select2())}if(e(document).on("click",".gazchaps-getaddress-io-lookup-button",function(){a(this)}),e(document).on("click",".gazchaps-getaddress-io-enter-address-manually-button",function(){var e,t;t="",(e=this).id.indexOf("billing_")>-1?t="billing":e.id.indexOf("shipping_")>-1&&(t="shipping"),t&&(o(t),e.closest(".form-row").style.display="none")}),e(document).on("change","#billing_gazchaps-woocommerce-getaddress-io-address-selector-select, #shipping_gazchaps-woocommerce-getaddress-io-address-selector-select",function(t){var d=t.target.options[t.target.selectedIndex].value;""==d&&(d="||||"),function(t,d){var s="billing";t.indexOf("shipping_")>-1&&(s="shipping"),d||(d="||||");for(var i,a,n=d.split("|"),r=["address_1","address_2","city","state"],_=0;_<r.length;_++)i=s+"_"+r[_],null!==(a=document.getElementById(i))&&(a.value=n[_]);"||||"!==d&&o(s),e(document.body).trigger("update_checkout")}(t.target.id,d)}),e(document).on("keydown",".billing_gazchaps_getaddress_io_postcode_field input, .shipping_gazchaps_getaddress_io_postcode_field input",function(t){if(!t.defaultPrevented){var d,s=!1;if(void 0!==t.key?"Enter"===t.key&&(s=!0):void 0!==t.keyCode&&13===t.keyCode&&(s=!0),s)return(d=e(this).attr("name").indexOf("billing_")>-1?e("#billing_gazchaps_getaddress_io_postcode_lookup_button_field_button"):e("#shipping_gazchaps_getaddress_io_postcode_lookup_button_field_button"))&&d.trigger("click"),t.preventDefault(),!1}}),gazchaps_getaddress_io.clear_additional_fields){var _=document.getElementsByClassName("woocommerce-additional-fields__field-wrapper");if(_.length>0)for(var c=0;c<_.length;c++)_[c].style.clear="both"}i(),e(document).on("updated_checkout",function(){i()})}(jQuery);