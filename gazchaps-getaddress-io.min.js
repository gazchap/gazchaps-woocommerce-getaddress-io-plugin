!function(e){var t=[];function d(e,t){if(gazchaps_getaddress_io.hide_address_fields&&gazchaps_getaddress_io.fields_to_hide&&gazchaps_getaddress_io.field_prefixes)for(var d in gazchaps_getaddress_io.field_prefixes){var o=gazchaps_getaddress_io.field_prefixes[d];if(!e||o===e){var s=!1,n=o+"_country",a=document.getElementById(n);a&&(a.value&&"GB"===a.value||a.options&&"GB"===a.options[a.selectedIndex].value)&&(s=!0);var r,_,c=!0;for(r in gazchaps_getaddress_io.fields_to_hide){_=o+"_"+gazchaps_getaddress_io.fields_to_hide[r];var l=document.getElementById(_);if(l&&""!==l.value){c=!1;break}}if(c&&s||"show"===t){for(r in gazchaps_getaddress_io.fields_to_hide){_=o+"_"+gazchaps_getaddress_io.fields_to_hide[r];var g=document.getElementById(_+"_field");g&&(g.style.display="hide"===t?"none":"")}"hide"===t&&i(o,"show")}else"hide"===t&&i(o,"hide")}}}function i(e,t){var d=e+"_gazchaps_getaddress_io_enter_address_manually_button_field",i=document.getElementById(d);i&&(i.style.display="hide"===t?"none":"")}function o(e){d(e,"hide")}function s(e){d(e,"show"),i(e,"hide")}function n(e){var d="";if(e.id.indexOf("billing_")>-1?d="billing":e.id.indexOf("shipping_")>-1&&(d="shipping"),d){var i=document.getElementById(d+"_postcode").value.replace(/[^A-Za-z0-9]/g,"").toUpperCase();i.length>0&&function(e,d,i){if(void 0!==t[e+"_"+d])return a(t[e+"_"+d]),void _(t[e+"_"+d]);var o;if(o="action=gazchaps_woocommerce_getaddress_io",o+="&postcode="+e,o+="&address_type="+d,XMLHttpRequest){i&&(i.innerText=gazchaps_getaddress_io.searching_text,i.disabled=!0);var s=new XMLHttpRequest;s.open("POST",gazchaps_getaddress_io.ajax_url),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.onload=function(){i&&(i.innerText=gazchaps_getaddress_io.button_text,i.disabled=!1);var o=JSON.parse(s.responseText);o.error_code?alert(o.error):(t[e+"_"+d]=o,a(o),_(o))},s.onerror=function(){i&&(i.innerText=gazchaps_getaddress_io.button_text,i.disabled=!1)},s.send(o)}}(i,d,e)}}function a(e){var t=document.getElementById(e.address_type+"_postcode");t&&e.postcode&&(t.value=e.postcode)}function r(e){return e+"_gazchaps-woocommerce-getaddress-io-address-selector"}function _(t){var d=r(t.address_type),i=document.getElementById(d);(i&&i.parentNode.removeChild(i),t.address_count>0)&&(document.getElementById(t.address_type+"_gazchaps_getaddress_io_postcode_lookup_button_field").insertAdjacentHTML("afterend",t.fragment.trim()),e&&e.fn.select2&&e("#"+d).find("select").select2())}if(e(document).on("click",".gazchaps-getaddress-io-lookup-button",(function(){n(this)})),e(document).on("click",".gazchaps-getaddress-io-enter-address-manually-button",(function(){var e,t;t="",(e=this).id.indexOf("billing_")>-1?t="billing":e.id.indexOf("shipping_")>-1&&(t="shipping"),t&&(s(t),e.closest(".form-row").style.display="none")})),e(document).on("change","#billing_gazchaps-woocommerce-getaddress-io-address-selector-select, #shipping_gazchaps-woocommerce-getaddress-io-address-selector-select",(function(t){var d=t.target.options[t.target.selectedIndex].value;""===d&&(d="||||"),function(t,d){var i="billing";t.indexOf("shipping_")>-1&&(i="shipping"),d||(d="||||");for(var o,n,a=d.split("|"),r=["address_1","address_2","city","state"],_=0;_<r.length;_++)o=i+"_"+r[_],null!==(n=document.getElementById(o))&&(n.value=a[_]);"||||"!==d&&s(i),e(document.body).trigger("update_checkout")}(t.target.id,d)})),e(document).on("change","#billing_country, #shipping_country",(function(t){var d,i,o="billing_country"===this.id?"billing":"shipping";"GB"===t.target.options[t.target.selectedIndex].value?(d=r(o),(i=e("#"+d)).find(":input").prop("disabled",!1),i.show()):function(t){var d=r(t),i=e("#"+d);i.hide(),i.find(":input").prop("disabled",!0)}(o)})),e(document).on("keydown",".billing_gazchaps_getaddress_io_postcode_field input, .shipping_gazchaps_getaddress_io_postcode_field input",(function(t){if(!t.defaultPrevented){var d,i=!1;if(void 0!==t.key?"Enter"===t.key&&(i=!0):void 0!==t.keyCode&&13===t.keyCode&&(i=!0),i)return(d=e(this).attr("name").indexOf("billing_")>-1?e("#billing_gazchaps_getaddress_io_postcode_lookup_button_field_button"):e("#shipping_gazchaps_getaddress_io_postcode_lookup_button_field_button"))&&d.trigger("click"),t.preventDefault(),!1}})),gazchaps_getaddress_io.clear_additional_fields){var c=document.getElementsByClassName("woocommerce-additional-fields__field-wrapper");if(c.length>0)for(var l=0;l<c.length;l++)c[l].style.clear="both"}o(),e(document).on("updated_checkout",(function(){o()}))}(jQuery);