!function(e){var t=[];function d(e,t){if(gazchaps_getaddress_io.hide_address_fields&&gazchaps_getaddress_io.fields_to_hide&&gazchaps_getaddress_io.field_prefixes){gazchaps_getaddress_io.fields_to_hide;for(var d in gazchaps_getaddress_io.field_prefixes){var a=gazchaps_getaddress_io.field_prefixes[d];if(!e||a===e){var i=!1,o=a+"_country",n=document.getElementById(o);n&&"GB"==n.options[n.selectedIndex].value&&(i=!0);var r=!0;for(var l in gazchaps_getaddress_io.fields_to_hide){var c=a+"_"+gazchaps_getaddress_io.fields_to_hide[l],_=document.getElementById(c);if(_&&""!=_.value){r=!1;break}}if(r&&i||"show"===t){for(var l in gazchaps_getaddress_io.fields_to_hide){c=a+"_"+gazchaps_getaddress_io.fields_to_hide[l];var g=document.getElementById(c+"_field");g&&(g.style.display="hide"==t?"none":"")}"hide"===t&&s(a,"show")}else"hide"===t&&s(a,"hide")}}}}function s(e,t){var d=e+"_gazchaps_getaddress_io_enter_address_manually_button_field",s=document.getElementById(d);s&&(s.style.display="hide"==t?"none":"")}function a(e){d(e,"hide")}function i(e){d(e,"show"),s(e,"hide")}function o(e){var d="";if(e.id.indexOf("billing_")>-1?d="billing":e.id.indexOf("shipping_")>-1&&(d="shipping"),d){var s=document.getElementById(d+"_postcode").value.replace(/[^A-Za-z0-9]/g,"").toUpperCase();s.length>0&&function(e,d,s){if(void 0!==t[e+"_"+d])return void n(t[e+"_"+d]);var a;if(a="action=gazchaps_woocommerce_getaddress_io",a+="&postcode="+e,a+="&address_type="+d,XMLHttpRequest){s&&(s.innerText=gazchaps_getaddress_io.searching_text,s.disabled=!0);var i=new XMLHttpRequest;i.open("POST",gazchaps_getaddress_io.ajax_url),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onload=function(){s&&(s.innerText=gazchaps_getaddress_io.button_text,s.disabled=!1);var a,o,r=JSON.parse(i.responseText);r.error_code?alert(r.error):(t[e+"_"+d]=r,a=r,(o=document.getElementById(a.address_type+"_postcode"))&&a.postcode&&(o.value=a.postcode),n(r))},i.onerror=function(){s&&(s.innerText=gazchaps_getaddress_io.button_text,s.disabled=!1)},i.send(a)}}(s,d,e)}}function n(t){var d=t.address_type+"_gazchaps-woocommerce-getaddress-io-address-selector",s=document.getElementById(d);(s&&s.parentNode.removeChild(s),t.address_count>0)&&(document.getElementById(t.address_type+"_gazchaps_getaddress_io_postcode_lookup_button_field").insertAdjacentHTML("afterend",t.fragment.trim()),e&&e.fn.select2&&e("#"+d).find("select").select2())}var r=document.getElementsByClassName("gazchaps-getaddress-io-lookup-button");if(r.length>0)for(var l=0;l<r.length;l++)r[l].addEventListener("click",function(e){o(this)});var c,_=document.getElementsByClassName("gazchaps-getaddress-io-enter-address-manually-button");if(_.length>0)for(l=0;l<_.length;l++)_[l].addEventListener("click",function(e){var t,d;d="",(t=this).id.indexOf("billing_")>-1?d="billing":t.id.indexOf("shipping_")>-1&&(d="shipping"),d&&(i(d),t.closest(".form-row").style.display="none")});if((e(".woocommerce-address-fields, .woocommerce-billing-fields, .woocommerce-shipping-fields").on("change","select",function(t){if("billing_gazchaps-woocommerce-getaddress-io-address-selector-select"==t.target.id||"shipping_gazchaps-woocommerce-getaddress-io-address-selector-select"==t.target.id){var d=t.target.options[t.target.selectedIndex].value;""==d&&(d="||||"),function(t,d){var s="billing";t.indexOf("shipping_")>-1&&(s="shipping");for(var a,o,n=d.split("|"),r=["address_1","address_2","city","state"],l=0;l<r.length;l++)a=s+"_"+r[l],null!==(o=document.getElementById(a))&&(o.value=n[l]);"||||"!==d&&i(s),e(document.body).trigger("update_checkout")}(t.target.id,d)}}),gazchaps_getaddress_io.clear_additional_fields)&&(c=document.getElementsByClassName("woocommerce-additional-fields__field-wrapper")).length>0)for(l=0;l<c.length;l++)c[l].style.clear="both";if(a(),e(document).on("updated_checkout",function(){a()}),(c=document.getElementsByClassName("woocommerce-additional-fields__field-wrapper")).length>0)for(l=0;l<c.length;l++)c[l].style.clear="both"}(jQuery);
